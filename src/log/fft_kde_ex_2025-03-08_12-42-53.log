2025-03-08 12:42:53,992 - INFO - GPU is available. CuPy will be used for FFT.
2025-03-08 12:42:54,793 - INFO - Using GPU device 1.
2025-03-08 12:42:54,793 - INFO - Output directory 'TNG300_ICS' is set to: /caefs/data/IllustrisTNG/300/ICS
2025-03-08 12:42:54,793 - INFO - Output directory 'TNG300_snapshot99' is set to: /caefs/data/IllustrisTNG/snapshot-99-dm-npy/cache
2025-03-08 12:42:54,793 - WARNING - Output directory 'NPZ' does not exist: /path/to/your/output/npz
2025-03-08 12:42:54,793 - INFO - Output directory 'NPY' is set to: /caefs/data/IllustrisTNG/300/ICS
2025-03-08 12:42:54,793 - WARNING - Output directory 'LOGS' does not exist: /path/to/your/logs
2025-03-08 12:42:54,794 - INFO - Snapshot99 데이터 폴더: /caefs/data/IllustrisTNG/snapshot-99-dm-npy/cache
2025-03-08 12:42:54,794 - INFO - Output directory: /caefs/user/mmingyeong/structura/Structura/src/results
2025-03-08 12:42:54,794 - INFO - 전체 Snapshot99 데이터를 로드합니다...
2025-03-08 12:42:54,797 - INFO - Using 4 workers based on available system memory.
2025-03-08 12:42:54,885 - ERROR - Unhandled exception occurred:
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
AttributeError: Can't pickle local object 'DataLoader.load_all_chunks.<locals>.<lambda>'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/caefs/user/mmingyeong/structura/Structura/src/example/fft_kde_ex.py", line 96, in <module>
    main()
  File "/caefs/user/mmingyeong/structura/Structura/src/example/fft_kde_ex.py", line 35, in main
    positions = loader.load_all_chunks(sampling_rate=1)
  File "/caefs/user/mmingyeong/structura/Structura/src/data_loader.py", line 210, in load_all_chunks
    for idx, chunk in enumerate(
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/concurrent/futures/process.py", line 575, in _chain_from_iterable_of_lists
    for element in iterable:
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/concurrent/futures/_base.py", line 621, in result_iterator
    yield _result_or_cancel(fs.pop())
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/concurrent/futures/_base.py", line 319, in _result_or_cancel
    return fut.result(timeout)
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
AttributeError: Can't pickle local object 'DataLoader.load_all_chunks.<locals>.<lambda>'
