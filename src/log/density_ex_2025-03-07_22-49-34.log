2025-03-07 22:49:35,117 - INFO - Using GPU device 1.
2025-03-07 22:49:35,119 - INFO - Output directory 'TNG300_ICS' is set to: /caefs/data/IllustrisTNG/300/ICS
2025-03-07 22:49:35,120 - INFO - Output directory 'TNG300_snapshot99' is set to: /caefs/data/IllustrisTNG/snapshot-99-dm-npy/cache
2025-03-07 22:49:35,120 - WARNING - Output directory 'NPZ' does not exist: /path/to/your/output/npz
2025-03-07 22:49:35,120 - INFO - Output directory 'NPY' is set to: /caefs/data/IllustrisTNG/300/ICS
2025-03-07 22:49:35,120 - WARNING - Output directory 'LOGS' does not exist: /path/to/your/logs
2025-03-07 22:49:35,121 - INFO - Snapshot99 데이터 폴더: /caefs/data/IllustrisTNG/snapshot-99-dm-npy/cache
2025-03-07 22:49:35,121 - INFO - Output directory: /caefs/user/mmingyeong/structura/Structura/src/results
2025-03-07 22:49:35,121 - INFO - 전체 Snapshot99 데이터를 로드합니다...
2025-03-07 23:20:08,466 - INFO - Time elapsed for loading all data chunks: 1833.34 seconds
2025-03-07 23:20:08,500 - INFO - Combined data shape: (1557030, 3)
2025-03-07 23:20:08,679 - INFO - Data statistics per column:
  Mean: [101.24802198 100.05790246 104.91102265]
  Median: [ 98.74384244  98.04238834 106.48209405]
  Minimum: [5.48032759e-05 1.48053876e-04 7.01534413e-04]
  Maximum: [204.99998949 204.99990272 204.99980019]
2025-03-07 23:20:08,679 - INFO - Projection axis 0 range: min = 5.480327592705331e-05, max = 204.9999894944222
2025-03-07 23:20:08,853 - INFO - 데이터 로드 완료, positions shape: (1557030, 3)
2025-03-07 23:20:08,853 - INFO - Density 계산을 위한 grid_bounds: {'x': (0, 30), 'y': (0, 30), 'z': (0, 30)}, grid_spacing: (1, 1, 1)
2025-03-07 23:20:08,854 - INFO - 3D 밀도 맵 계산 시작...
2025-03-07 23:20:08,854 - ERROR - Unhandled exception occurred:
Traceback (most recent call last):
  File "/caefs/user/mmingyeong/structura/Structura/src/example/density_ex.py", line 150, in <module>
    main()
  File "/caefs/user/mmingyeong/structura/Structura/src/example/density_ex.py", line 106, in main
    x_centers, y_centers, z_centers, density_map, used_h = calculator.calculate_density_map(selected_kernel_func, h, return_used_h=True)
TypeError: DensityCalculator.calculate_density_map() got an unexpected keyword argument 'return_used_h'
