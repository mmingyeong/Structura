2025-04-21 21:18:00,612 - ERROR - Unhandled exception occurred:
Traceback (most recent call last):
  File "/caefs/user/mmingyeong/structura/Structura/src/example/density_kde_seq_chunks/00_TestDensity.py", line 203, in <module>
    main()
  File "/caefs/user/mmingyeong/structura/Structura/src/example/density_kde_seq_chunks/00_TestDensity.py", line 176, in main
    x_centers, y_centers, z_centers, density_map = calc.calculate_density_map(kernel=kernel_func, h=bandwidth)
  File "/caefs/user/mmingyeong/structura/Structura/src/density.py", line 332, in calculate_density_map
    _pcd_triangular(self.particles, density_map,
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/site-packages/numba/core/dispatcher.py", line 424, in _compile_for_args
    error_rewrite(e, 'typing')
  File "/home/users/mmingyeong/.conda/envs/new_env/lib/python3.10/site-packages/numba/core/dispatcher.py", line 365, in error_rewrite
    raise e.with_traceback(None)
numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
Failed in nopython mode pipeline (step: nopython frontend)
Unknown attribute 'size' of type none

File "../../density.py", line 75:
    def _fast_sqrt_lut(x: float, table_x: np.ndarray, table_y: np.ndarray) -> float:
        n = table_x.size
        ^

During: typing of get attribute at /caefs/user/mmingyeong/structura/Structura/src/density.py (75)

File "../../density.py", line 75:
    def _fast_sqrt_lut(x: float, table_x: np.ndarray, table_y: np.ndarray) -> float:
        n = table_x.size
        ^

During: Pass nopython_type_inference
During: resolving callee type: type(CPUDispatcher(<function _fast_sqrt_lut at 0x7f3163cdcca0>))
During: typing of call at /caefs/user/mmingyeong/structura/Structura/src/density.py (205)

During: resolving callee type: type(CPUDispatcher(<function _fast_sqrt_lut at 0x7f3163cdcca0>))
During: typing of call at /caefs/user/mmingyeong/structura/Structura/src/density.py (205)


File "../../density.py", line 205:
    def _pcd_triangular(
        <source elided>
                            if sq <= h2:
                                dist = (_fast_sqrt_lut(sq, table_x, table_y)
                                ^

During: Pass nopython_type_inference
